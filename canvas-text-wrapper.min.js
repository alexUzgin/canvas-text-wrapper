!function(e){function t(t,i,r){"use strict";var o={font:"18px Arial, sans-serif",sizeToFill:!1,maxFontSizeToFill:!1,lineHeight:1.1,allowNewLine:!0,lineBreak:"auto",textAlign:"left",verticalAlign:"top",justifyLines:!1,paddingX:0,paddingY:0,fitParent:!1,strokeText:!1,renderHDPI:!0,textDecoration:"none",offsetX:0,offsetY:0,txtWidth:0,txtHeight:0},n={};for(var a in o)n[a]=r.hasOwnProperty(a)?r[a]:o[a];console.log("inside canvastext wrapper",n);var l=t.getContext("2d");l.font=n.font,l.textBaseline="bottom";var s=1,f="undefined"!=typeof global?global.devicePixelRatio:e.devicePixelRatio;if(n.renderHDPI&&f>1){var h={};for(var a in l)h[a]=l[a];var p=t.width,d=t.height;s=f,t.width=p*s,t.height=d*s,t.style.width=p*s*.5+"px",t.style.height=d*s*.5+"px";for(var a in h)try{l[a]=h[a]}catch(e){}l.scale(s,s)}var g,x=(n.fitParent?t.parentNode.clientWidth:t.width)/s,w=(n.fitParent?t.parentNode.clientHeight:t.height)/s,c=(x=n.txtWidth>0?n.txtWidth:x,w=n.txtWidth>0?n.txtHeight:w,n.txtWidth>0?n.txtWidth:x-2*n.paddingX),u=n.txtHeight>0?n.txtHeight:w-2*n.paddingY,m=n.offsetX>0?n.offsetX:0,y=n.offsetY>0?n.offsetY:0,T=n.font.match(/\d+(px|em|%)/g)?+n.font.match(/\d+(px|em|%)/g)[0].match(/\d+/g):18,b=0,v=[],L=[],P={x:0,y:0},A=0,H="​";function N(e){g||(g=n.sizeToFill?l.font.split(/\b\d+px\b/i):n.font.split(/\b\d+px\b/i)),l.font=g[0]+e+"px"+g[1]}function k(e){N(e),A=e,C()}function C(){if(n.allowNewLine)for(var e=i.trim().split("\n"),t=0,r=0;t<e.length-1;t++)r+=e[t].trim().split(/\s+/).length,L.push(r);var o,a,s,f,h=i.trim().split(/\s+/);(o=h).forEach(function(e,t){if(a="",l.measureText(e).width>c){for(var i=0;l.measureText(a+e[i]).width<=c&&i<e.length;i++)a+=e[i];s=e.slice(0,i),f=e.slice(i),o.splice(t,1,s,f)}}),function(e){v=[];for(var t=0,i=0;t<e.length;i++)if(v[i]="","auto"===n.lineBreak){if(l.measureText(v[i]+e[t]).width>c)break;for(;l.measureText(v[i]+e[t]).width<=c&&t<e.length;)if(v[i]+=e[t]+" ",t++,n.allowNewLine)for(var r=0;r<L.length;r++)if(L[r]===t){v[++i]="";break}v[i]=v[i].trim()}else v[i]=e[t],t++}(h),b=v.length*A}function E(e,t,i){var r=l.measureText(e).width;switch(l.textAlign){case"center":t-=r/2;break;case"right":t-=r}l.beginPath(),l.moveTo(t,i),l.lineTo(t+r,i),l.stroke()}return i=function(e){do{e=e.replace(/\n\n/g,"\n"+H+"\n")}while(e.indexOf("\n\n")>-1);return e}(i),N(T),isNaN(n.lineHeight)?-1!==n.lineHeight.toString().indexOf("px")?A=parseInt(n.lineHeight):-1!==n.lineHeight.toString().indexOf("%")&&(A=parseInt(n.lineHeight)/100*T):A=T*n.lineHeight,function(){if("string"!=typeof i)throw new TypeError("The second parameter must be a String.");if(isNaN(T))throw new TypeError('Cannot parse "font".');if(isNaN(A))throw new TypeError('Cannot parse "lineHeight".');if("left"!==n.textAlign.toLocaleLowerCase()&&"center"!==n.textAlign.toLocaleLowerCase()&&"right"!==n.textAlign.toLocaleLowerCase())throw new TypeError('Property "textAlign" must be set to either "left", "center", or "right".');if("top"!==n.verticalAlign.toLocaleLowerCase()&&"middle"!==n.verticalAlign.toLocaleLowerCase()&&"bottom"!==n.verticalAlign.toLocaleLowerCase())throw new TypeError('Property "verticalAlign" must be set to either "top", "middle", or "bottom".');if("boolean"!=typeof n.justifyLines)throw new TypeError('Property "justifyLines" must be a Boolean.');if(isNaN(n.paddingX))throw new TypeError('Property "paddingX" must be a Number.');if(isNaN(n.paddingY))throw new TypeError('Property "paddingY" must be a Number.');if("boolean"!=typeof n.fitParent)throw new TypeError('Property "fitParent" must be a Boolean.');if("auto"!==n.lineBreak.toLocaleLowerCase()&&"word"!==n.lineBreak.toLocaleLowerCase())throw new TypeError('Property "lineBreak" must be set to either "auto" or "word".');if("boolean"!=typeof n.sizeToFill)throw new TypeError('Property "sizeToFill" must be a Boolean.');if("boolean"!=typeof n.strokeText)throw new TypeError('Property "strokeText" must be a Boolean.');if("boolean"!=typeof n.renderHDPI)throw new TypeError('Property "renderHDPI" must be a Boolean.');if("none"!==n.textDecoration.toLocaleLowerCase()&&"underline"!==n.textDecoration.toLocaleLowerCase())throw new TypeError('Property "textDecoration" must be set to either "none" or "underline".')}(),function(){if(n.sizeToFill){var e=i.trim().split(/\s+/).length,t=0,r=!1!==n.maxFontSizeToFill;do{if(r){if(!(++t<=n.maxFontSizeToFill))break;k(t)}else k(++t)}while(b<u&&v.join(" ").split(/\s+/).length==e);k(--t)}else C();n.justifyLines&&"auto"===n.lineBreak&&function(){for(var e,t,i,r,o,n,a,s,f=0;f<v.length;f++)i=l.measureText(v[f]).width,(!e||i>e)&&(e=i,t=f);for(f=0;f<v.length;f++)if(f!==t&&!((r=v[f].trim().split(/\s+/).length)<=1)){v[f]=v[f].trim().split(/\s+/).join(" "),o=l.measureText(" ").width,n=(e-l.measureText(v[f]).width)/o,a=n/(r-1),s="";for(var h=0;h<a;h++)s+=" ";v[f]=v[f].trim().split(" ").join(s)}}();"middle"==n.verticalAlign?P.y=(w-b)/2:"bottom"==n.verticalAlign?P.y=w-b-n.paddingY:P.y=n.paddingY,l.textAlign=n.textAlign,"center"==n.textAlign?P.x=x/2:"right"==n.textAlign?P.x=x-n.paddingX:P.x=n.paddingX,function(){for(var e=H+" ",t=0;t<v.length;t++)P.y=parseInt(P.y)+A,v[t]!==e&&(l.fillText(v[t],P.x+m,P.y+y),n.strokeText&&l.strokeText(v[t],P.x,P.y),"underline"===n.textDecoration.toLocaleLowerCase()&&E(v[t],P.x,P.y))}()}(),v}"module"in e&&"exports"in module?module.exports=t:e.CanvasTextWrapper=t}(this);
